\subsection{Distance Estimation}

\subsubsection{Setup}

BlueCrystal4 was used to run the distance estimation pipeline across the dataset.
Minor adjustments to the load\_model() methods of the DPT and DepthAnything classes
were made in order to configure ONNX Runtime to utilise all CPU cores allocated by
SLURM (28 in this case).

It is also worth noting that for these distance estimation runs, the manual calibration
frame masks were used.
The reason for this was to maximise the consistency of the masks due to a drop in the
quality of the automated masks at longer distances (see analysis section).

\subsubsection{Configurations}

Four distinct configurations of the distance estimation pipeline were applied to the
dataset.
Each configuration combined one of two detection methods (BBOX, BBOX -> SAM) with one
of two distance estimation models (DPT, Depth Anything).

\vspace{3mm}

\textbf{3.3.2.1~~~~Detection Methods}\vspace{4.5mm}\\
Both detection methods use Mega Detector as a starting point to generate bounding boxes
enclosing the animal.

For the plain BBOX detection method, all pixels enclosed in these bounding boxes are used
as candidates during the later-stage calculation of detection distance from the depth maps
generated by either DPT or DepthAnything.
Specifically, once the depth estimation model has predicted a distance for each pixel, the
distance estimate for the entire detection is calculated to be equal to that of the pixel
corresponding to the 20th percentile depth of all pixels within the bounding box.

The BBOX -> SAM method, however, introduces an additional step in which the generated bounding
boxes are passed to Segment Anything Model which subsequently predicts segmentation masks for
the detection.
It is these segmented pixels exclusively that are used in the later detection distance calculation.
In contrast to the plain BBOX detection method where distance is calculated based on
percentile, the BBOX -> SAM method detection distance is calculated as equal to the distance
estimate of the pixel corresponding to the centre-most point of the segmentation mask (i.e., the pixel
that is furthest from the segmentation boundary).

calibration\_mask\_frames flag





DPT/BBOX, DPT/SAM, DA/BBOX, DA/SAM

Code adjustments for blue crystal

Variable calibration runs

Depth map diagrams